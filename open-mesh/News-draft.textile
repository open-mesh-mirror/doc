h1. DRAFT: Batman-adv 2021.1 released

May 18th, 2021. Today the B.A.T.M.A.N. team publishes the May 2021 update to batman-adv, batctl and alfred! batctl gained the support for "*_json" commands which make it possible to query the batman-adv kernel module over generic netlink and receive the answer as JSON. The alfred server was modified to start the server even when batman-adv or interface(s) are not yet available. A special parameter "--force" must be provided to enable this behavior. Also several bugfixes and code cleanups are included in this version.

As the kernel module always depends on the Linux kernel it is compiled against, it does not make sense to provide binaries on our website. As usual, you will find the signed tarballs in our download section:

https://downloads.open-mesh.org/batman/releases/batman-adv-2021.1/

h2. Thanks

Thanks to all people sending in patches:

* Alexander Sarmanow <asarmanow@gmail.com>
* Leon Romanovsky <leonro@nvidia.com>
* Linus LÃ¼ssing <linus.luessing@c0d3.blue>
* Masahiro Yamada <masahiroy@kernel.org>
* Sebastian Andrzej Siewior <bigeasy@linutronix.de>
* Taehee Yoo <ap420073@gmail.com>
* Sven Eckelmann <sven@narfation.org>
* Simon Wunderlich <sw@simonwunderlich.de>
* Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>

and to all those that supported us with good advice or rigorous testing:

* Marek Lindner <mareklindner@neomailbox.ch>

h2. batman-adv

<pre>
$ git describe origin/master
v2021.0-14-g007b4c4b
$ range=v2021.0..v2021.0-14-g007b4c4b
$ git shortlog --email --no-merges "${range}"
$ git log --no-merges "${range}"|grep -e '\(Reported\|Tested\|Acked\|Reviewed-by\|Co-authored-by\)-by'|sed 's/.*:/*/'|sort|uniq



new kernel version
==================

      batman-adv: convert ifmcaddr6 to RCU
      batman-adv: Use netif_rx_any_context().
      batman-adv: remove never implemented MODULE_SUPPORTED_DEVICE

coding style cleanup/refactoring
================================

      batman-adv: Update copyright years for 2021
      batman-adv: Avoid sizeof on flexible structure
      batman-adv: Fix names for kernel-doc blocks
      batman-adv: Drop publication years from copyright info
      batman-adv: Fix misspelled "wont"
      batman-adv: remove redundant 'depends on NET'
      batman-adv: Fix order of kernel doc in batadv_priv

various
=======


bugfixes
========

      batman-adv: initialize "struct batadv_tvlv_tt_vlan_data"->reserved field


2021.1 (2021-05-18)
===================

* support latest kernels (4.4 - 5.13)
* coding style cleanups and refactoring
* bugs squashed:

  - correctly initialize padding when sending out translation table TVLVs
</pre>

h2. batctl

<pre>
$ git describe origin/master
v2021.0-38-g35d8327
$ range=v2021.0..v2021.0-38-g35d8327
$ git shortlog --email --no-merges "${range}"
$ git log --no-merges "${range}"|grep -e '\(Reported\|Tested\|Acked\|Reviewed-by\|Co-authored-by\)-by'|sed 's/.*:/*/'|sort|uniq


features
========

      batctl: netlink: Make netlink_query_common non-static
      batctl: genl_json: Add generic JSON interface
      batctl: Introduce JSON_* command types
      batctl: Introduce handler for JSON_* command types
      batctl: Add neighbors_json command
      batctl: Add originators_json command
      batctl: Add transtable_global_json command
      batctl: Add transtable_local_json command
      batctl: Consume genl ACKs after setting reads
      batctl: throughputmeter: Use global genl socket
      batctl: interface: List using shared genl socket
      batctl: Get meshif info using shared genl socket
      batctl: Use common genl socket for netlink_query_common
      batctl: routing_algo: List using shared genl socket
      batctl: originators: Get outgoing ifname from netlink
      batctl: neighbors: Get outgoing ifname from netlink
      batctl: ping: Get outgoing ifname from netlink
      batctl: event: Get ifname from netlink message
      batctl: Realign netlink_policy array
      batctl: translocal: Simplify evaluation of last_seen
      batctl: netlink: Allow to use netlink_query_common hardif/vlan
      batctl: Add bla_backbone_json command
      batctl: Add bla_claim_json command
      batctl: Add dat_cache_json command
      batctl: Add gateways_json command
      batctl: Add hardif_json command
      batctl: Add hardifs_json command
      batctl: Add mcast_flags_json command
      batctl: Add mesh_json command
      batctl: Add vlan_json command


coding style cleanup/refactoring
================================

      batctl: Fix build of routing_algo against musl
      batctl: Update copyright years for 2021
      batctl: Drop publication years from copyright info
      batctl: Avoid boolean in structures
      batctl: Reorder and clean up README
      batctl: Don't mention log command in manpage

bugfixes
========



2021.1 (2021-05-18)
===================

* add various commands to print generic netlink replies as JSON
* coding style cleanups and refactoring


</pre>

h2. alfred

<pre>
$ git describe origin/master
v2021.0-7-ge9a3bfc
$ range=v2021.0..v2021.0-7-ge9a3bfc
$ git shortlog --email --no-merges "${range}"
$ git log --no-merges "${range}"|grep -e '\(Reported\|Tested\|Acked\|Reviewed-by\|Co-authored-by\)-by'|sed 's/.*:/*/'|sort|uniq


Sven Eckelmann <sven@narfation.org> (6):
      alfred: Update copyright years for 2021
      alfred: Drop publication years from copyright info
      alfred: Show error message for invalid batadv interface
      alfred: Allow exactly one interface for secondary mode
      alfred: Save global mode flags in bitfield
      alfred: Allow start of server without valid interface


2021.1 (2021-05-18)
===================

* Allow to force of alfred startup when the interfaces don't work/exist (yet)
* coding style cleanups and refactoring
</pre>


Happy routing,

The B.A.T.M.A.N. team